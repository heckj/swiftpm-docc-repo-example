{
  "abstract" : [
    {
      "text" : "Learn about the security features that the package manager implements.",
      "type" : "text"
    }
  ],
  "hierarchy" : {
    "paths" : [
      [
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs"
      ]
    ]
  },
  "identifier" : {
    "interfaceLanguage" : "swift",
    "url" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity"
  },
  "kind" : "article",
  "metadata" : {
    "modules" : [
      {
        "name" : "Swift Package Manager"
      }
    ],
    "role" : "article",
    "roleHeading" : "Article",
    "title" : "Package Security"
  },
  "primaryContentSections" : [
    {
      "content" : [
        {
          "anchor" : "Trust-on-First-Use",
          "level" : 2,
          "text" : "Trust on First Use",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "The package manager records ",
              "type" : "text"
            },
            {
              "inlineContent" : [
                {
                  "text" : "fingerprints",
                  "type" : "text"
                }
              ],
              "type" : "strong"
            },
            {
              "text" : " of downloaded package versions so that",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "it can perform ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/en.wikipedia.org\/wiki\/Trust_on_first_use",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "(TOFU).",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "That is, when a package version is downloaded for the first time, the package manager trusts that",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "it has downloaded the correct contents and requires subsequent downloads of the same",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "package version to have the same fingerprint.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "If the fingerprint changes, it might be an indicator that the package has been",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "compromised and the package manager either warns or returns an error.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "Depending on where a package version is downloaded from, a different value is",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "used as its fingerprint:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "header" : "row",
          "rows" : [
            [
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Package Version Origin",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ],
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Fingerprint",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            ],
            [
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Git repository",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ],
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Git hash of the revision",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            ],
            [
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Package registry",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ],
              [
                {
                  "inlineContent" : [
                    {
                      "text" : "Checksum of the source archive",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            ]
          ],
          "type" : "table"
        },
        {
          "inlineContent" : [
            {
              "text" : "The package manager keeps version fingerprints for each package in a single file",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "under the ",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/security\/fingerprints",
              "type" : "codeVoice"
            },
            {
              "text" : " directory.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "For a Git repository package, the fingerprint filename takes the form of ",
                      "type" : "text"
                    },
                    {
                      "code" : "{PACKAGE_NAME}-{REPOSITORY_URL_HASH}.json",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " (such as ",
                      "type" : "text"
                    },
                    {
                      "code" : "LinkedList-5ddbcf15.json",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : ").",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "For a registry package, the fingerprint filename takes the form of ",
                      "type" : "text"
                    },
                    {
                      "code" : "{PACKAGE_ID}.json",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " (such as ",
                      "type" : "text"
                    },
                    {
                      "code" : "mona.LinkedList.json",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : ").",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "For packages retrieved from a registry, the package manager expects all registries to provide consistent fingerprints for packages they host.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "If the archive is downloaded for the first time, the package manager ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/RegistryServerSpecification#42-Fetch-information-about-a-package-release",
              "isActive" : true,
              "overridingTitle" : "fetches metadata of the package release",
              "overridingTitleInlineContent" : [
                {
                  "text" : "fetches metadata of the package release",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " to obtain the expected checksum.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Otherwise, the package manager compares the checksum with that in local storage (",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/security\/fingerprints\/",
              "type" : "codeVoice"
            },
            {
              "text" : "), saved from previous download.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "If registries have conflicting fingerprints, the package manager reports an error.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "You can reduce the error to a warning by setting the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/SwiftBuild",
              "isActive" : true,
              "overridingTitle" : "build",
              "overridingTitleInlineContent" : [
                {
                  "text" : "build",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " option ",
              "type" : "text"
            },
            {
              "code" : "--resolver-fingerprint-checking",
              "type" : "codeVoice"
            },
            {
              "text" : " to ",
              "type" : "text"
            },
            {
              "code" : "warn",
              "type" : "codeVoice"
            },
            {
              "text" : " (default is ",
              "type" : "text"
            },
            {
              "code" : "strict",
              "type" : "codeVoice"
            },
            {
              "text" : ").",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Package-signing",
          "level" : 3,
          "text" : "Package signing",
          "type" : "heading"
        },
        {
          "anchor" : "Signed-packages-from-a-registry",
          "level" : 4,
          "text" : "Signed packages from a registry",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "A registry may support or require signing.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To sign a package release, package authors set either the ",
              "type" : "text"
            },
            {
              "code" : "signing-identity",
              "type" : "codeVoice"
            },
            {
              "text" : " (for reading from operating system’s identity store such as Keychain in macOS), or ",
              "type" : "text"
            },
            {
              "code" : "private-key-path",
              "type" : "codeVoice"
            },
            {
              "text" : " and ",
              "type" : "text"
            },
            {
              "code" : "cert-chain-paths",
              "type" : "codeVoice"
            },
            {
              "text" : " (for reading from files) options of the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageRegistryPublish",
              "isActive" : true,
              "overridingTitle" : "swift package-registry publish",
              "overridingTitleInlineContent" : [
                {
                  "code" : "swift package-registry publish",
                  "type" : "codeVoice"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " subcommand so the package manager can locate the signing key and certificate.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "If the certificate chain’s root and intermediates are known by the package manager, the package author would only needs to provide the leaf signing certificate in ",
              "type" : "text"
            },
            {
              "code" : "cert-chain-paths",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "Otherwise, the package author should be provide the entire certificate chain as ",
              "type" : "text"
            },
            {
              "code" : "cert-chain-paths",
              "type" : "codeVoice"
            },
            {
              "text" : " so that all of the certificates are included in the signature, making it possible for the package manager to reconstruct the certificate chain for validation later.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "This is applicable to ",
              "type" : "text"
            },
            {
              "code" : "signing-identity",
              "type" : "codeVoice"
            },
            {
              "text" : " as well. That is, you can use ",
              "type" : "text"
            },
            {
              "code" : "signing-identity",
              "type" : "codeVoice"
            },
            {
              "text" : " in combination with ",
              "type" : "text"
            },
            {
              "code" : "cert-chain-paths",
              "type" : "codeVoice"
            },
            {
              "text" : " to provide the entire certificate chain.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "If the root of the signing certificate is not in the package manager’s default trust store, the package author is responsible for telling package users to include the root certificate in their local ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Trusted-vs-untrusted-certificate",
              "isActive" : true,
              "overridingTitle" : "trust roots",
              "overridingTitleInlineContent" : [
                {
                  "text" : "trust roots",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " directory, otherwise ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Validating-signed-packages",
              "isActive" : true,
              "overridingTitle" : "signature validation",
              "overridingTitleInlineContent" : [
                {
                  "text" : "signature validation",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " may fail upon download because the signing certificate is not trusted.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "For more information on signed registry packages, see ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/UsingSwiftPackageRegistry#Publishing-to-Registry",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Validating-signed-packages",
          "level" : 5,
          "text" : "Validating signed packages",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "The package manager determines if a downloaded archive is signed by checking for presence of the ",
              "type" : "text"
            },
            {
              "code" : "X-Swift-Package-Signature-Format",
              "type" : "codeVoice"
            },
            {
              "text" : " and ",
              "type" : "text"
            },
            {
              "code" : "X-Swift-Package-Signature",
              "type" : "codeVoice"
            },
            {
              "text" : " headers in the HTTP response.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "It then performs a series of validations based on user’s ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/UsingSwiftPackageRegistry#Security-configuration",
              "isActive" : true,
              "overridingTitle" : "security configuration",
              "overridingTitleInlineContent" : [
                {
                  "text" : "security configuration",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "If the archive is unsigned, the package manager will error\/prompt\/warn\/allow based on the ",
                      "type" : "text"
                    },
                    {
                      "code" : "signing.onUnsigned",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " configuration.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "If the archive is signed, the package manage validates the signature and the signing certificate chain.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "anchor" : "Trusted-vs-untrusted-certificate",
          "level" : 6,
          "text" : "Trusted vs. untrusted certificate",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "A certificate is trusted if it is chained to any root in the package manager’s trust store, which consists of:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The package manager’s default trust store, if ",
                      "type" : "text"
                    },
                    {
                      "code" : "signing.includeDefaultTrustedRootCertificates",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " is ",
                      "type" : "text"
                    },
                    {
                      "code" : "true",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : ".",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "Custom root(s) in the configured trusted roots directory at ",
                      "type" : "text"
                    },
                    {
                      "code" : "signing.trustedRootCertificatesPath",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : ". Certificates must be DER-encoded.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "Otherwise, a certificate is untrusted and handled according to the ",
              "type" : "text"
            },
            {
              "code" : "signing.onUntrustedCertificate",
              "type" : "codeVoice"
            },
            {
              "text" : " configuration.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "If a user opts to continue with the untrusted certificate, the package manager proceeds as if it were an unsigned package.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Certificate-policies",
          "level" : 6,
          "text" : "Certificate policies",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "The package manager requires all certificates used for package signing to have the “code signing” extended key usage extension. They must also satisfy the core policies from ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/www.rfc-editor.org\/rfc\/rfc5280",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ", as implemented by ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/github.com\/apple\/swift-certificates",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "Users can configure certificate expiry and revocation check through the ",
              "type" : "text"
            },
            {
              "code" : "signing.validationChecks.certificateExpiration",
              "type" : "codeVoice"
            },
            {
              "text" : " and ",
              "type" : "text"
            },
            {
              "code" : "signing.validationChecks.certificateRevocation",
              "type" : "codeVoice"
            },
            {
              "text" : " configuration, respectively. Note that revocation check implicitly requires expiry check.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "An invalid signing certificate would result in the package manager rejecting the archive when downloading from a registry, or the package collection.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Signed-package-collections",
          "level" : 4,
          "text" : "Signed package collections",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "Package collection publishers may ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollections#Protecting-package-collections",
              "isActive" : true,
              "overridingTitle" : "sign a collection to protect its contents",
              "overridingTitleInlineContent" : [
                {
                  "text" : "sign a collection to protect its contents",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " from tampering.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "If a collection is signed, the package manager checks that the signature is valid before importing it; or returns an error if any of these fails:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The file’s contents, signature excluded, must match what was used to generate the signature.",
                      "type" : "text"
                    },
                    {
                      "text" : " ",
                      "type" : "text"
                    },
                    {
                      "text" : "In other words, this checks to see if the collection was altered after it was signed.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The signing certificate must meet all the ",
                      "type" : "text"
                    },
                    {
                      "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Requirements-on-signing-certificate",
                      "isActive" : true,
                      "overridingTitle" : "requirements",
                      "overridingTitleInlineContent" : [
                        {
                          "text" : "requirements",
                          "type" : "text"
                        }
                      ],
                      "type" : "reference"
                    },
                    {
                      "text" : ".",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "Since signing a package collection is optional, the package manager prompts users for confirmation before they can add an ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Unsigned-package-collections",
              "isActive" : true,
              "overridingTitle" : "unsigned collection",
              "overridingTitleInlineContent" : [
                {
                  "text" : "unsigned collection",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "identifier" : "https:\/\/github.com\/apple\/swift-package-collection-generator\/tree\/main\/Sources\/PackageCollectionSigner",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " helps publishers sign their package collections.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To generate a signature you need to provide:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The package collection file to be signed.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "A DER-encoded code signing certificate.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The PEM-encoded certificate’s private key.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The certificate’s chain in its entirety.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "A signed package collection has an extra ",
              "type" : "text"
            },
            {
              "code" : "signature",
              "type" : "codeVoice"
            },
            {
              "text" : " object:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "{",
            "  ...,",
            "  \"signature\": {",
            "    \"signature\": \"<SIGNATURE>\",",
            "    \"certificate\": {",
            "      \"subject\": {",
            "        \"commonName\": \"Jane Doe\",",
            "        ...",
            "      },",
            "      \"issuer\": {",
            "        \"commonName\": \"Sample CA\",",
            "        ...",
            "      }",
            "    }",
            "  }",
            "}"
          ],
          "syntax" : "json",
          "type" : "codeListing"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The package manager uses the signature string (represented by ",
                      "type" : "text"
                    },
                    {
                      "code" : "\"<SIGNATURE>\"",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : ") is used to verify the contents of the collection file haven’t been tampered with after it was signed. The package manager signs the collection when a user ",
                      "type" : "text"
                    },
                    {
                      "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd",
                      "isActive" : true,
                      "overridingTitle" : "adds the collection",
                      "overridingTitleInlineContent" : [
                        {
                          "text" : "adds the collection",
                          "type" : "text"
                        }
                      ],
                      "type" : "reference"
                    },
                    {
                      "text" : " to their configured list of collections. It includes the certificate’s public key and chain.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "code" : "certificate",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " contains details extracted from the signing certificate. ",
                      "type" : "text"
                    },
                    {
                      "code" : "subject.commonName",
                      "type" : "codeVoice"
                    },
                    {
                      "text" : " should be consistent with the name of the publisher so that it’s recognizable by users. The root of the certificate must be ",
                      "type" : "text"
                    },
                    {
                      "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Trusted-root-certificates",
                      "isActive" : true,
                      "overridingTitle" : "installed and trusted on users’ machines",
                      "overridingTitleInlineContent" : [
                        {
                          "text" : "installed and trusted on users’ machines",
                          "type" : "text"
                        }
                      ],
                      "type" : "reference"
                    },
                    {
                      "text" : ".",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "For more information on adding signed package collections, see ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Signed-package-collections",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Requirements-on-signing-certificate",
          "level" : 6,
          "text" : "Requirements on signing certificate",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "Certificates used for signing package collections must meet the following requirements, which are checked and enforced during signature generation (publishers) and verification (Swift Package Manager users):",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The timestamp at which signing\/verification is done must fall within the signing certificate’s validity period.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The certificate’s “Extended Key Usage” extension must include “Code Signing”.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The certificate must use either 256-bit EC (recommended for enhanced security) or 2048-bit RSA key.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The certificate must not be revoked. The certificate authority must support OCSP, which means the certificate must have the “Certificate Authority Information Access” extension that includes OCSP as a method, specifying the responder’s URL.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "The certificate chain is valid and root certificate must be trusted.",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "Non-expired, non-revoked Swift Package Collection certificates from ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/developer.apple.com",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " satisfy all of the criteria above.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Trusted-root-certificates",
          "level" : 6,
          "text" : "Trusted root certificates",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "Since generating a collection signature requires a certificate, part of the signature check involves validating the certificate and its chain and making sure that the root certificate is trusted.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "On Apple platforms, all root certificates that come preinstalled with the OS are automatically trusted.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Users may include additional certificates to trust by placing them in the ",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/config\/trust-root-certs",
              "type" : "codeVoice"
            },
            {
              "text" : " directory.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "On non-Apple platforms, there are no trusted root certificates by default other than those shipped with the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollections#Protecting-package-collections",
              "isActive" : true,
              "overridingTitle" : "certificate-pinning configuration",
              "overridingTitleInlineContent" : [
                {
                  "text" : "certificate-pinning configuration",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Only those found in ",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/config\/trust-root-certs",
              "type" : "codeVoice"
            },
            {
              "text" : " are trusted.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "This means that the signature check will always fail unless the ",
              "type" : "text"
            },
            {
              "code" : "trust-root-certs",
              "type" : "codeVoice"
            },
            {
              "text" : " directory is set up.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "Users can explicitly specify they trust a publisher and any collections they publish, by obtaining that publisher’s root certificate and saving it to ",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/config\/trust-root-certs",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "The root certificates must be DER-encoded.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Since the package manager trusts all certificate chains under a root, depending on what roots are installed, some publishers may already be trusted implicitly and users don’t need to explicitly specify each one.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "With the ",
              "type" : "text"
            },
            {
              "code" : "package-collection-sign",
              "type" : "codeVoice"
            },
            {
              "text" : " tool, the root certificate provided as input for signing a collection is automatically trusted.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "When a package manager user tries to add the collection, however, the root certificate must either be preinstalled with the OS (Apple platforms only) or found in the ",
              "type" : "text"
            },
            {
              "code" : "~\/.swiftpm\/config\/trust-root-certs",
              "type" : "codeVoice"
            },
            {
              "text" : " directory (all platforms) or shipped with the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollections#Protecting-package-collections",
              "isActive" : true,
              "overridingTitle" : "certificate-pinning configuration",
              "overridingTitleInlineContent" : [
                {
                  "text" : "certificate-pinning configuration",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : ", otherwise the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Signed-package-collections",
              "isActive" : true,
              "overridingTitle" : "signature check",
              "overridingTitleInlineContent" : [
                {
                  "text" : "signature check",
                  "type" : "text"
                }
              ],
              "type" : "reference"
            },
            {
              "text" : " fails. Collection publishers should make the DER-encoded root certificate(s) that they use downloadable so that users can adjust their setup if needed.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        }
      ],
      "kind" : "content"
    }
  ],
  "schemaVersion" : {
    "major" : 0,
    "minor" : 3,
    "patch" : 0
  },
  "sections" : [

  ],
  "seeAlsoSections" : [
    {
      "anchor" : "Essentials",
      "generated" : true,
      "identifiers" : [
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/GettingStarted",
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/IntroducingPackages"
      ],
      "title" : "Essentials"
    }
  ],
  "variants" : [
    {
      "paths" : [
        "\/documentation\/packagemanagerdocs\/packagesecurity"
      ],
      "traits" : [
        {
          "interfaceLanguage" : "swift"
        }
      ]
    }
  ]
, 
"references": {
"command-icon.svg": {
  "alt" : null,
  "identifier" : "command-icon.svg",
  "type" : "image",
  "variants" : [
    {
      "traits" : [
        "1x",
        "light"
      ],
      "url" : "\/images\/PackageManagerDocs\/command-icon.svg"
    },
    {
      "traits" : [
        "1x",
        "dark"
      ],
      "url" : "\/images\/PackageManagerDocs\/command-icon~dark.svg"
    }
  ]
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs": {
  "abstract" : [
    {
      "text" : "Organize, manage, and edit Swift packages.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs",
  "kind" : "symbol",
  "role" : "collection",
  "title" : "Swift Package Manager",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/GettingStarted": {
  "abstract" : [
    {
      "text" : "Learn to create and use Swift packages.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/GettingStarted",
  "kind" : "article",
  "role" : "article",
  "title" : "Getting Started",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/gettingstarted"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/IntroducingPackages": {
  "abstract" : [
    {
      "text" : "Learn to create and use a Swift package.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/IntroducingPackages",
  "kind" : "article",
  "role" : "article",
  "title" : "Introducing Packages",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/introducingpackages"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageCollectionAdd": {
  "abstract" : [
    {
      "text" : "Add a new collection.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd",
  "images" : [
    {
      "identifier" : "command-icon.svg",
      "type" : "icon"
    }
  ],
  "kind" : "article",
  "role" : "article",
  "title" : "swift package-collection add",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagecollectionadd"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageCollectionAdd#Signed-package-collections": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Signed-package-collections",
  "kind" : "section",
  "title" : "Signed package collections",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagecollectionadd#Signed-package-collections"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageCollectionAdd#Trusted-root-certificates": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Trusted-root-certificates",
  "kind" : "section",
  "title" : "Trusted root certificates",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagecollectionadd#Trusted-root-certificates"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageCollectionAdd#Unsigned-package-collections": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollectionAdd#Unsigned-package-collections",
  "kind" : "section",
  "title" : "Unsigned package collections",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagecollectionadd#Unsigned-package-collections"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageCollections#Protecting-package-collections": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageCollections#Protecting-package-collections",
  "kind" : "section",
  "title" : "Protecting package collections",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagecollections#Protecting-package-collections"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageRegistryPublish": {
  "abstract" : [
    {
      "text" : "Publish to a registry.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageRegistryPublish",
  "images" : [
    {
      "identifier" : "command-icon.svg",
      "type" : "icon"
    }
  ],
  "kind" : "article",
  "role" : "article",
  "title" : "swift package-registry publish",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packageregistrypublish"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageSecurity#Requirements-on-signing-certificate": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Requirements-on-signing-certificate",
  "kind" : "section",
  "title" : "Requirements on signing certificate",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagesecurity#Requirements-on-signing-certificate"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageSecurity#Trusted-vs-untrusted-certificate": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Trusted-vs-untrusted-certificate",
  "kind" : "section",
  "title" : "Trusted vs. untrusted certificate",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagesecurity#Trusted-vs-untrusted-certificate"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/PackageSecurity#Validating-signed-packages": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/PackageSecurity#Validating-signed-packages",
  "kind" : "section",
  "title" : "Validating signed packages",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/packagesecurity#Validating-signed-packages"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/RegistryServerSpecification#42-Fetch-information-about-a-package-release": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/RegistryServerSpecification#42-Fetch-information-about-a-package-release",
  "kind" : "section",
  "title" : "4.2. Fetch information about a package release",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/registryserverspecification#42-Fetch-information-about-a-package-release"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/SwiftBuild": {
  "abstract" : [
    {
      "text" : "Build sources into binary products.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/SwiftBuild",
  "images" : [
    {
      "identifier" : "command-icon.svg",
      "type" : "icon"
    }
  ],
  "kind" : "article",
  "role" : "article",
  "title" : "swift build",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/swiftbuild"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/UsingSwiftPackageRegistry#Publishing-to-Registry": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/UsingSwiftPackageRegistry#Publishing-to-Registry",
  "kind" : "section",
  "title" : "Publishing to Registry",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/usingswiftpackageregistry#Publishing-to-Registry"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/UsingSwiftPackageRegistry#Security-configuration": {
  "abstract" : [

  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/UsingSwiftPackageRegistry#Security-configuration",
  "kind" : "section",
  "title" : "Security configuration",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/usingswiftpackageregistry#Security-configuration"
},
"https://developer.apple.com": {
  "identifier" : "https:\/\/developer.apple.com",
  "title" : "developer.apple.com",
  "titleInlineContent" : [
    {
      "text" : "developer.apple.com",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/developer.apple.com"
},
"https://en.wikipedia.org/wiki/Trust_on_first_use": {
  "identifier" : "https:\/\/en.wikipedia.org\/wiki\/Trust_on_first_use",
  "title" : "trust-on-first-use",
  "titleInlineContent" : [
    {
      "text" : "trust-on-first-use",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/en.wikipedia.org\/wiki\/Trust_on_first_use"
},
"https://github.com/apple/swift-certificates": {
  "identifier" : "https:\/\/github.com\/apple\/swift-certificates",
  "title" : "swift-certificates",
  "titleInlineContent" : [
    {
      "text" : "swift-certificates",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/github.com\/apple\/swift-certificates"
},
"https://github.com/apple/swift-package-collection-generator/tree/main/Sources/PackageCollectionSigner": {
  "identifier" : "https:\/\/github.com\/apple\/swift-package-collection-generator\/tree\/main\/Sources\/PackageCollectionSigner",
  "title" : "package-collection-sign",
  "titleInlineContent" : [
    {
      "code" : "package-collection-sign",
      "type" : "codeVoice"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/github.com\/apple\/swift-package-collection-generator\/tree\/main\/Sources\/PackageCollectionSigner"
},
"https://www.rfc-editor.org/rfc/rfc5280": {
  "identifier" : "https:\/\/www.rfc-editor.org\/rfc\/rfc5280",
  "title" : "RFC 5280",
  "titleInlineContent" : [
    {
      "text" : "RFC 5280",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/www.rfc-editor.org\/rfc\/rfc5280"
}
}
}