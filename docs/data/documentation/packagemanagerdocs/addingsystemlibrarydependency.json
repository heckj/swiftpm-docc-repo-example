{
  "abstract" : [
    {
      "text" : "Define the location for the library and provide module map to expose C headers to Swift.",
      "type" : "text"
    }
  ],
  "hierarchy" : {
    "paths" : [
      [
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs",
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/AddingDependencies"
      ]
    ]
  },
  "identifier" : {
    "interfaceLanguage" : "swift",
    "url" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/AddingSystemLibraryDependency"
  },
  "kind" : "article",
  "metadata" : {
    "modules" : [
      {
        "name" : "Swift Package Manager"
      }
    ],
    "role" : "article",
    "roleHeading" : "Article",
    "title" : "Adding a dependency on a system library."
  },
  "primaryContentSections" : [
    {
      "content" : [
        {
          "anchor" : "Overview",
          "level" : 2,
          "text" : "Overview",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "You can link against system libraries, using them as a dependency in your code, using the package manager.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To do so, add a ",
              "type" : "text"
            },
            {
              "code" : "target",
              "type" : "codeVoice"
            },
            {
              "text" : " of type ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/developer.apple.com\/documentation\/packagedescription\/target\/systemlibrary(name:path:pkgconfig:providers:)",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ", and a ",
              "type" : "text"
            },
            {
              "code" : "module.modulemap",
              "type" : "codeVoice"
            },
            {
              "text" : " for each system library you’re using.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Using-pkg-config-to-provide-header-and-linker-search-paths",
          "level" : 3,
          "text" : "Using pkg-config to provide header and linker search paths",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "For Unix-like systems, Swift Package Manager can use ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/en.wikipedia.org\/wiki\/Pkg-config",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " to provide the compiler with the paths for including library headers and linking to binaries.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "If your system doesn’t provide pkgConfig, or the library doesn’t include package config files, you can provide the options to the Swift compiler directly.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "code" : "pkgConfig",
              "type" : "codeVoice"
            },
            {
              "text" : " looks up libraries by name, which is the paramter that you pass to the systemLibrary target.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "The following two examples illustrate using ",
              "type" : "text"
            },
            {
              "code" : "libgit2",
              "type" : "codeVoice"
            },
            {
              "text" : " to manually look up paths for that library:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "$ pkg-config --cflags libgit2",
            "-I\/opt\/homebrew\/Cellar\/libgit2\/1.9.0\/include"
          ],
          "syntax" : "bash",
          "type" : "codeListing"
        },
        {
          "inlineContent" : [
            {
              "text" : "To manually provide search paths for headers, use the ",
              "type" : "text"
            },
            {
              "code" : "-Xcc -I\/path\/to\/include\/",
              "type" : "codeVoice"
            },
            {
              "text" : " as additional parameters to ",
              "type" : "text"
            },
            {
              "code" : "swift build",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To match the above example from ",
              "type" : "text"
            },
            {
              "code" : "pkgConfig",
              "type" : "codeVoice"
            },
            {
              "text" : ", the additional command line options would be:",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "code" : "-Xcc -I\/opt\/homebrew\/Cellar\/libgit2\/1.9.0\/include",
              "type" : "codeVoice"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "$ pkg-config --libs-only-L libgit2",
            "-L\/opt\/homebrew\/Cellar\/libgit2\/1.9.0\/lib"
          ],
          "syntax" : "bash",
          "type" : "codeListing"
        },
        {
          "inlineContent" : [
            {
              "text" : "To manually provide search paths for linking to binaries, use the ",
              "type" : "text"
            },
            {
              "code" : "-Xlinker -L\/path\/to\/include\/",
              "type" : "codeVoice"
            },
            {
              "text" : " as additional parameters to ",
              "type" : "text"
            },
            {
              "code" : "swift build",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To match the above example from ",
              "type" : "text"
            },
            {
              "code" : "pkgConfig",
              "type" : "codeVoice"
            },
            {
              "text" : ", the additional command line options would be:",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "code" : "-Xlinker -L\/opt\/homebrew\/Cellar\/libgit2\/1.9.0\/lib",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Declaring-the-system-library",
          "level" : 3,
          "text" : "Declaring the system library",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "The ",
              "type" : "text"
            },
            {
              "code" : "systemLibrary",
              "type" : "codeVoice"
            },
            {
              "text" : " definition informs the Swift compiler of where to find the C library.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "When building on Unix-like systems, the package manager can use ",
              "type" : "text"
            },
            {
              "code" : "pkg-config",
              "type" : "codeVoice"
            },
            {
              "text" : " to look up where a library is installed.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Specify the name of the C library you want to look up for the ",
              "type" : "text"
            },
            {
              "code" : "pkgConfig",
              "type" : "codeVoice"
            },
            {
              "text" : " parameter.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To use the Swift Package Manager to install the package locally, if it isn’t already installed, you can specify one or more providers.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "The following example provides a declaration for the ",
              "type" : "text"
            },
            {
              "code" : "libgit2",
              "type" : "codeVoice"
            },
            {
              "text" : " library, installing the library with homebrew on macOS or apt on a Debian based Linux system:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            ".systemLibrary(",
            "    name: \"Clibgit\",",
            "    pkgConfig: \"libgit2\",",
            "    providers: [",
            "        .brew([\"libgit2\"]),",
            "        .apt([\"libgit2-dev\"])",
            "    ]",
            ")"
          ],
          "syntax" : "swift",
          "type" : "codeListing"
        },
        {
          "anchor" : "Authoring-a-module-map",
          "level" : 3,
          "text" : "Authoring a module map",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "The ",
              "type" : "text"
            },
            {
              "code" : "module.modulemap",
              "type" : "codeVoice"
            },
            {
              "text" : " file declares the C library headers, and what parts of them, to expose as one or more clang modules that can be imported in Swift code.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Each defines:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "items" : [
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "A name for the module to be exposed",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "One or more header files to reference",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "A reference to the name of the C library",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            },
            {
              "content" : [
                {
                  "inlineContent" : [
                    {
                      "text" : "One or more export lines that identify what to expose to Swift",
                      "type" : "text"
                    }
                  ],
                  "type" : "paragraph"
                }
              ]
            }
          ],
          "type" : "unorderedList"
        },
        {
          "inlineContent" : [
            {
              "text" : "For example, the following module map uses the header ",
              "type" : "text"
            },
            {
              "code" : "git2.h",
              "type" : "codeVoice"
            },
            {
              "text" : ", links to ",
              "type" : "text"
            },
            {
              "code" : "libgit2",
              "type" : "codeVoice"
            },
            {
              "text" : ", and exports all functions defined in the header ",
              "type" : "text"
            },
            {
              "code" : "git2.h",
              "type" : "codeVoice"
            },
            {
              "text" : " to Swift:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "module Clibgit [system] {",
            "  header \"git2.h\"",
            "  link \"git2\"",
            "  export *",
            "}"
          ],
          "syntax" : null,
          "type" : "codeListing"
        },
        {
          "inlineContent" : [
            {
              "text" : "Try to reference headers that reside in the same directory or as a local path to provide the greatest flexibility.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "You can use an absolute path, although that makes the declaration more brittle, as different systems install system libraries in a variety of paths.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "content" : [
            {
              "inlineContent" : [
                {
                  "text" : "Not all libraries are easily made into modules. You may have to create additional shim headers to provide the Swift compiler with the references needed to fully compile and link the library.",
                  "type" : "text"
                }
              ],
              "type" : "paragraph"
            }
          ],
          "name" : "Note",
          "style" : "note",
          "type" : "aside"
        },
        {
          "inlineContent" : [
            {
              "text" : "For more information on the structure of module maps, see the ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/llvm.org\/",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " documentation: ",
              "type" : "text"
            },
            {
              "identifier" : "https:\/\/clang.llvm.org\/docs\/Modules.html#module-map-language",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Versioning-Modules-from-system-libraries",
          "level" : 4,
          "text" : "Versioning Modules from system libraries",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "When creating a module map, follow the conventions of system packagers as you name the module with version information.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "For example, the Debian package for ",
              "type" : "text"
            },
            {
              "code" : "python3",
              "type" : "codeVoice"
            },
            {
              "text" : " is called ",
              "type" : "text"
            },
            {
              "code" : "python3",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "In Debian, there is not a single package for python; the system packagers designed it to be installed side-by-side with other versions.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "Based on that, a recommended name for a module map for ",
              "type" : "text"
            },
            {
              "code" : "python3",
              "type" : "codeVoice"
            },
            {
              "text" : " on a Debian system is ",
              "type" : "text"
            },
            {
              "code" : "CPython3",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "System-Libraries-With-Optional-Dependencies",
          "level" : 4,
          "text" : "System Libraries With Optional Dependencies",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "To reference a system library with optional dependencies, you need to make another package to represent the optional library.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "For example, the library ",
              "type" : "text"
            },
            {
              "code" : "libarchive",
              "type" : "codeVoice"
            },
            {
              "text" : " optionally depends on ",
              "type" : "text"
            },
            {
              "code" : "xz",
              "type" : "codeVoice"
            },
            {
              "text" : ", which means it can be compiled with ",
              "type" : "text"
            },
            {
              "code" : "xz",
              "type" : "codeVoice"
            },
            {
              "text" : " support, but it isn’t required.",
              "type" : "text"
            },
            {
              "text" : " ",
              "type" : "text"
            },
            {
              "text" : "To provide a package that uses libarchive with xz, make a ",
              "type" : "text"
            },
            {
              "code" : "CArchive+CXz",
              "type" : "codeVoice"
            },
            {
              "text" : " package that depends on ",
              "type" : "text"
            },
            {
              "code" : "CXz",
              "type" : "codeVoice"
            },
            {
              "text" : " and provides ",
              "type" : "text"
            },
            {
              "code" : "CArchive",
              "type" : "codeVoice"
            },
            {
              "text" : ".",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        }
      ],
      "kind" : "content"
    }
  ],
  "schemaVersion" : {
    "major" : 0,
    "minor" : 3,
    "patch" : 0
  },
  "sections" : [

  ],
  "seeAlsoSections" : [
    {
      "anchor" : "Related-Documentation",
      "identifiers" : [
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ExampleSystemLibraryPkgConfig"
      ],
      "title" : "Related Documentation"
    },
    {
      "generated" : true,
      "identifiers" : [
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ResolvingPackageVersions",
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ResolvingDependencyFailures",
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ExampleSystemLibraryPkgConfig",
        "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/EditingDependencyPackage"
      ]
    }
  ],
  "variants" : [
    {
      "paths" : [
        "\/documentation\/packagemanagerdocs\/addingsystemlibrarydependency"
      ],
      "traits" : [
        {
          "interfaceLanguage" : "swift"
        }
      ]
    }
  ]
, 
"references": {
"doc://PackageManagerDocs/documentation/PackageManagerDocs": {
  "abstract" : [
    {
      "text" : "Organize, manage, and edit Swift packages.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs",
  "kind" : "symbol",
  "role" : "collection",
  "title" : "Swift Package Manager",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/AddingDependencies": {
  "abstract" : [
    {
      "text" : "Use other swift packages, system libraries, or binary dependencies in your package.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/AddingDependencies",
  "kind" : "article",
  "role" : "collectionGroup",
  "title" : "Adding dependencies to a Swift package",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/addingdependencies"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/EditingDependencyPackage": {
  "abstract" : [
    {
      "text" : "Temporarily switch a remote dependency to local in order to edit the dependency.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/EditingDependencyPackage",
  "kind" : "article",
  "role" : "article",
  "title" : "Editing a remote dependency used in a Swift package",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/editingdependencypackage"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/ExampleSystemLibraryPkgConfig": {
  "abstract" : [
    {
      "text" : "Create an Command-line executable package that uses libgit2 as a system library dependency.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ExampleSystemLibraryPkgConfig",
  "kind" : "article",
  "role" : "article",
  "title" : "Swift package example that uses system library dependency with pkg-config",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/examplesystemlibrarypkgconfig"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/ResolvingDependencyFailures": {
  "abstract" : [
    {
      "text" : "Understand dependency failure scenarios.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ResolvingDependencyFailures",
  "kind" : "article",
  "role" : "article",
  "title" : "Resolving package dependency failures",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/resolvingdependencyfailures"
},
"doc://PackageManagerDocs/documentation/PackageManagerDocs/ResolvingPackageVersions": {
  "abstract" : [
    {
      "text" : "Coordinate and constrain dependencies for your package.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/PackageManagerDocs\/documentation\/PackageManagerDocs\/ResolvingPackageVersions",
  "kind" : "article",
  "role" : "article",
  "title" : "Resolving and updating dependencies",
  "type" : "topic",
  "url" : "\/documentation\/packagemanagerdocs\/resolvingpackageversions"
},
"https://clang.llvm.org/docs/Modules.html#module-map-language": {
  "identifier" : "https:\/\/clang.llvm.org\/docs\/Modules.html#module-map-language",
  "title" : "Module Map Language",
  "titleInlineContent" : [
    {
      "text" : "Module Map Language",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/clang.llvm.org\/docs\/Modules.html#module-map-language"
},
"https://developer.apple.com/documentation/packagedescription/target/systemlibrary(name:path:pkgconfig:providers:)": {
  "identifier" : "https:\/\/developer.apple.com\/documentation\/packagedescription\/target\/systemlibrary(name:path:pkgconfig:providers:)",
  "title" : "systemLibrary",
  "titleInlineContent" : [
    {
      "text" : "systemLibrary",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/developer.apple.com\/documentation\/packagedescription\/target\/systemlibrary(name:path:pkgconfig:providers:)"
},
"https://en.wikipedia.org/wiki/Pkg-config": {
  "identifier" : "https:\/\/en.wikipedia.org\/wiki\/Pkg-config",
  "title" : "pkgConfig",
  "titleInlineContent" : [
    {
      "text" : "pkgConfig",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/en.wikipedia.org\/wiki\/Pkg-config"
},
"https://llvm.org/": {
  "identifier" : "https:\/\/llvm.org\/",
  "title" : "LLVM",
  "titleInlineContent" : [
    {
      "text" : "LLVM",
      "type" : "text"
    }
  ],
  "type" : "link",
  "url" : "https:\/\/llvm.org\/"
}
}
}